{% extends 'base.html' %}

{% block title %}Dashboard - Infinity School{% endblock %}

{% block header %}
<div class="nav-menu">
    <a href="#" class="btn btn-secondary">ğŸ  Dashboard</a>
    <a href="#" class="btn btn-secondary">ğŸ‘¤ Perfil</a>
    <a href="#" class="btn btn-secondary">ğŸ“… CalendÃ¡rio</a>
    <a href="#" class="btn btn-secondary">ğŸ“ AnotaÃ§Ãµes</a>
    <a href="#" class="btn btn-secondary">ğŸ”” NotificaÃ§Ãµes</a>
</div>
{% endblock %}

{% block content %}
    <div class="dashboard-welcome">
        <h2>Bem-vindo(a), JoÃ£o Silva! ğŸ‘‹</h2>
        <p class="text-muted">Aqui estÃ¡ seu painel de produtividade e organizaÃ§Ã£o da Infinity School.</p>
    </div>

    <!-- Menu Central Dashboard -->
    <div class="dashboard-grid">
        <!-- Links para Planilhas e Sistemas -->
        <div class="card">
            <h3>ğŸ“Š Planilhas e Documentos</h3>
            <p class="text-muted mb-4">Acesse rapidamente suas planilhas do Google Drive</p>
            <div class="btn-group">
                <a href="https://drive.google.com" target="_blank" class="btn btn-primary">ğŸ“ˆ Planilhas Google Drive</a>
                <a href="#" class="btn btn-secondary">ğŸ“‹ Planejamento PedagÃ³gico</a>
                <a href="#" class="btn btn-secondary">âœ… Lista de Chamada</a>
            </div>
        </div>

        <!-- Portal do Aluno e Infinity App -->
        <div class="card">
            <h3>ğŸ“ Sistemas AcadÃªmicos</h3>
            <p class="text-muted mb-4">Acesse os sistemas principais da escola</p>
            <div class="btn-group">
                <a href="#" class="btn btn-primary">ğŸ« Portal do Aluno</a>
                <a href="#" class="btn btn-secondary">ğŸ“± Infinity App</a>
                <a href="#" class="btn btn-secondary">ğŸ“š Biblioteca Digital</a>
            </div>
        </div>

        <!-- CalendÃ¡rio Interativo -->
        <div class="card">
            <h3>ğŸ“… CalendÃ¡rio Pessoal</h3>
            <p class="text-muted mb-4">Organize suas tarefas e compromissos</p>
            <div class="calendar-preview">
                <div class="calendar-header">
                    <button class="btn-nav" onclick="previousMonth()">â€¹</button>
                    <span id="currentMonth">Janeiro 2025</span>
                    <button class="btn-nav" onclick="nextMonth()">â€º</button>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <!-- CalendÃ¡rio serÃ¡ gerado via JavaScript -->
                </div>
            </div>
            <div class="btn-group mt-4">
                <button class="btn btn-primary" onclick="addTask()">â• Nova Tarefa</button>
                <button class="btn btn-secondary" onclick="viewMonth()">ğŸ“… Ver MÃªs Completo</button>
            </div>
        </div>

        <!-- Checklist de Tarefas -->
        <div class="card">
            <h3>âœ… Tarefas do Dia</h3>
            <p class="text-muted mb-4">Suas tarefas pendentes para hoje</p>
            <div class="task-list" id="taskList">
                <div class="task-item">
                    <input type="checkbox" id="task1" class="task-checkbox">
                    <label for="task1" class="task-label">Preparar aula de matemÃ¡tica</label>
                    <span class="task-category reuniao">ReuniÃ£o</span>
                </div>
                <div class="task-item">
                    <input type="checkbox" id="task2" class="task-checkbox">
                    <label for="task2" class="task-label">Revisar provas do 3Âº ano</label>
                    <span class="task-category entrega">Entrega</span>
                </div>
                <div class="task-item">
                    <input type="checkbox" id="task3" class="task-checkbox">
                    <label for="task3" class="task-label">ReuniÃ£o com coordenaÃ§Ã£o</label>
                    <span class="task-category evento">Evento</span>
                </div>
            </div>
            <button class="btn btn-primary mt-4" onclick="addNewTask()">â• Adicionar Tarefa</button>
        </div>

        <!-- NotificaÃ§Ãµes e Lembretes -->
        <div class="card">
            <h3>ğŸ”” NotificaÃ§Ãµes</h3>
            <p class="text-muted mb-4">Lembretes e avisos importantes</p>
            <div class="notification-list">
                <div class="notification-item">
                    <div class="notification-icon">â°</div>
                    <div class="notification-content">
                        <strong>ReuniÃ£o em 30 minutos</strong>
                        <p class="text-muted">ReuniÃ£o pedagÃ³gica - Sala 201</p>
                    </div>
                </div>
                <div class="notification-item">
                    <div class="notification-icon">ğŸ“</div>
                    <div class="notification-content">
                        <strong>Prazo de entrega</strong>
                        <p class="text-muted">RelatÃ³rio mensal - AtÃ© amanhÃ£</p>
                    </div>
                </div>
                <div class="notification-item">
                    <div class="notification-icon">ğŸ‰</div>
                    <div class="notification-content">
                        <strong>Evento prÃ³ximo</strong>
                        <p class="text-muted">Feira de ciÃªncias - Sexta-feira</p>
                    </div>
                </div>
            </div>
            <button class="btn btn-secondary mt-4">Ver Todas</button>
        </div>

        <!-- AnotaÃ§Ãµes RÃ¡pidas (Post-it Digital) -->
        <div class="card">
            <h3>ğŸ“ AnotaÃ§Ãµes RÃ¡pidas</h3>
            <p class="text-muted mb-4">Suas notas e lembretes pessoais</p>
            <div class="notes-container" id="notesContainer">
                <div class="note-item" style="background-color: #fef3c7;">
                    <p>Lembrar de imprimir provas para segunda-feira</p>
                    <button class="note-delete" onclick="deleteNote(this)">Ã—</button>
                </div>
                <div class="note-item" style="background-color: #dbeafe;">
                    <p>Comprar material para experimento de quÃ­mica</p>
                    <button class="note-delete" onclick="deleteNote(this)">Ã—</button>
                </div>
                <div class="note-item" style="background-color: #dcfce7;">
                    <p>Agendar reuniÃ£o com pais do aluno Pedro</p>
                    <button class="note-delete" onclick="deleteNote(this)">Ã—</button>
                </div>
            </div>
            <div class="add-note-form">
                <textarea id="newNote" placeholder="Digite sua anotaÃ§Ã£o..." class="note-input"></textarea>
                <div class="note-colors">
                    <button class="color-btn" style="background-color: #fef3c7;" onclick="setNoteColor('#fef3c7')"></button>
                    <button class="color-btn" style="background-color: #dbeafe;" onclick="setNoteColor('#dbeafe')"></button>
                    <button class="color-btn" style="background-color: #dcfce7;" onclick="setNoteColor('#dcfce7')"></button>
                    <button class="color-btn" style="background-color: #fce7f3;" onclick="setNoteColor('#fce7f3')"></button>
                </div>
                <button class="btn btn-primary" onclick="addNote()">â• Adicionar Nota</button>
            </div>
        </div>
    </div>

    <!-- Modal para adicionar tarefa -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3>Nova Tarefa</h3>
            <form id="taskForm">
                <input type="text" id="taskTitle" placeholder="TÃ­tulo da tarefa" required>
                <input type="date" id="taskDate" required>
                <select id="taskCategory">
                    <option value="reuniao">ReuniÃ£o</option>
                    <option value="entrega">Entrega</option>
                    <option value="evento">Evento</option>
                    <option value="pessoal">Pessoal</option>
                </select>
                <textarea id="taskDescription" placeholder="DescriÃ§Ã£o (opcional)"></textarea>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Tarefa</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // VariÃ¡veis globais
        let currentDate = new Date();
        let selectedNoteColor = '#fef3c7';

        // InicializaÃ§Ã£o
        document.addEventListener('DOMContentLoaded', function() {
            generateCalendar();
            loadTasks();
        });

        // FunÃ§Ãµes do calendÃ¡rio
        function generateCalendar() {
            const calendar = document.getElementById('calendarGrid');
            const monthYear = document.getElementById('currentMonth');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            monthYear.textContent = new Intl.DateTimeFormat('pt-BR', { 
                month: 'long', 
                year: 'numeric' 
            }).format(currentDate);
            
            // Limpar calendÃ¡rio
            calendar.innerHTML = '';
            
            // CabeÃ§alho dos dias da semana
            const daysOfWeek = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'SÃ¡b'];
            daysOfWeek.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day-header';
                dayElement.textContent = day;
                calendar.appendChild(dayElement);
            });
            
            // Primeiro dia do mÃªs
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            // Gerar dias
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = date.getDate();
                
                if (date.getMonth() !== month) {
                    dayElement.classList.add('other-month');
                }
                
                if (date.toDateString() === new Date().toDateString()) {
                    dayElement.classList.add('today');
                }
                
                // Adicionar eventos fictÃ­cios
                if (Math.random() > 0.8) {
                    const event = document.createElement('div');
                    event.className = 'calendar-event';
                    event.textContent = 'â€¢';
                    dayElement.appendChild(event);
                }
                
                calendar.appendChild(dayElement);
            }
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
        }

        // FunÃ§Ãµes de tarefas
        function addTask() {
            document.getElementById('taskModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('taskModal').style.display = 'none';
        }

        function addNewTask() {
            const taskList = document.getElementById('taskList');
            const newTask = document.createElement('div');
            newTask.className = 'task-item';
            newTask.innerHTML = `
                <input type="checkbox" id="task${Date.now()}" class="task-checkbox">
                <label for="task${Date.now()}" class="task-label">Nova tarefa</label>
                <span class="task-category pessoal">Pessoal</span>
            `;
            taskList.appendChild(newTask);
        }

        // FunÃ§Ãµes de anotaÃ§Ãµes
        function addNote() {
            const noteText = document.getElementById('newNote').value.trim();
            if (!noteText) return;
            
            const notesContainer = document.getElementById('notesContainer');
            const newNote = document.createElement('div');
            newNote.className = 'note-item';
            newNote.style.backgroundColor = selectedNoteColor;
            newNote.innerHTML = `
                <p>${noteText}</p>
                <button class="note-delete" onclick="deleteNote(this)">Ã—</button>
            `;
            
            notesContainer.appendChild(newNote);
            document.getElementById('newNote').value = '';
        }

        function deleteNote(button) {
            button.parentElement.remove();
        }

        function setNoteColor(color) {
            selectedNoteColor = color;
            document.querySelectorAll('.color-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
        }

        // Outras funÃ§Ãµes
        function viewMonth() {
            alert('Funcionalidade de visualizaÃ§Ã£o completa do mÃªs serÃ¡ implementada');
        }

        function loadTasks() {
            // Simular carregamento de tarefas
            console.log('Tarefas carregadas');
        }

        // Fechar modal ao clicar fora
        window.onclick = function(event) {
            const modal = document.getElementById('taskModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
    </script>
{% endblock %}
