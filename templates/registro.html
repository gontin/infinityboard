{% extends 'base.html' %}

{% block title %}Registro - Infinity School{% endblock %}

{% block header_title %}Registro{% endblock %}

{% block content %}
<div class="login-container">
    <div class="login-card">
        <h2>Registro de Funcionário</h2>

        <form method="post" enctype="multipart/form-data" class="login-form">
            {% csrf_token %}

            <div class="form-group">
                <label for="username">Usuário:</label>
                <input type="text" id="username" name="username" required>
            </div>

            <div class="form-group">
                <label for="email">E-mail:</label>
                <input type="email" id="email" name="email" required>
            </div>

            <div class="form-group">
                <label for="senha">Senha:</label>
                <input type="password" id="senha" name="senha" required>
            </div>

            <div class="form-group">
                <label for="nome">Nome completo:</label>
                <input type="text" id="nome" name="nome" required>
            </div>

            <div class="form-group">
                <label for="funcao">Função:</label>
                <input type="text" id="funcao" name="funcao" required>
            </div>

            <div class="form-group">
                <label for="cpf">CPF:</label>
                <input type="text" id="cpf" name="cpf" required>
            </div>

            <div class="form-group">
                <label for="foto-upload" class="btn btn-primary upload-img-label">
                    Escolher Foto de Perfil
                </label>
                <input type="file" id="foto-upload" name="foto" accept="image/*" required>
                <img id="preview-img" src="#" alt="Prévia da imagem" style="display:none;" />
            </div>

            <button type="submit" class="btn btn-primary">Registrar</button>
        </form>

        {% if erro %}
            <p style="color: red; margin-top: 10px;">{{ erro }}</p>
        {% endif %}

        <div class="login-links">
            <a href="{% url 'login' %}">Já tem conta? Entrar</a>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const inputFile = document.getElementById('foto-upload');
  const previewImg = document.getElementById('preview-img');

  inputFile.addEventListener('change', function() {
    const file = this.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        previewImg.src = e.target.result;
        previewImg.style.display = 'block';
      };
      reader.readAsDataURL(file);
    } else {
      previewImg.style.display = 'none';
    }
  });
</script>
{% endblock %}